function generatehash(t,r){return CryptoJS.HmacSHA1(t,r)}function constructDepartureURL(t,r,e,n){var i="/v3/departures/route_type/"+t+"/stop/"+r+"/route/"+e+"?direction_id="+n+"&"+params;return ptvbaseurl+i+"&signature="+generatehash(i,key).toString()}function constructArrivalURL(t,r,e){var n="/v3/pattern/run/"+t+"/route_type/"+r+"?stop_id="+e+"&"+params;return ptvbaseurl+n+"&signature="+generatehash(n,key).toString()}function filtertrains(t,r,e,n){return t.departures.filter(function(t){var i=moment(t.scheduled_departure_utc).unix();return i>r-e&&i<r+n})}function filterforstop(t,r){return t.departures.filter(function(t){return t.stop_id==r})}function showtraindepartures(){window.location="./index.html"}function timeconversion(t,r){var e;if(0===r)return e="<ul class='list-group'>",$.each(t,function(t,r){e+="<li class='list-group-item'><a class='"+r.stop_id+"' id='"+r.run_id+"' onclick='showbuses(this)'>"+new Date(r.scheduled_departure_utc).toLocaleTimeString()+"</a></li>"}),e+="</ul>";if(1==r)return e="<p class='list-group-item'>"+new Date(t[0].scheduled_departure_utc).toLocaleTimeString()+"</p>";if(2==r)return e="<p class='list-group-item'>"+new Date(t[0].scheduled_departure_utc).toLocaleTimeString()+"</p>",e+="<button type='button' onclick='showtraindepartures()' class='btn btn-primary'>Back to train station</button>";throw"You broke it"}function showbuses(t){$("#trainList, #trainList2").hide();var r,e=constructArrivalURL(t.id,0,1023);$.getJSON(e,function(t){r=filterforstop(t,1023),$("#busList").html("<h2>Train/Bus Connections</h2>"),$("#busList").append("<h3 class='text-primary'>Train arrives</h3>"+timeconversion(r,1));var e=constructDepartureURL(2,10885,952,29);$.getJSON(e,function(t){var e=filtertrains(t,moment(r[0].scheduled_departure_utc).unix(),0,3600);$("#busList").append("<h3 class='text-primary'>Bus departs</h3>"+timeconversion(e,2))})})}function showtrainbusconnection(t,r){$.getJSON(t,function(t){var r=filtertrains(t,moment().unix(),900,900);$("#trainList").html("<h2 class='text-primary'>Belgrave</h2>"+timeconversion(r,0))}),$.getJSON(r,function(t){var r=filtertrains(t,moment().unix(),900,900);$("#trainList2").html("<h2 class='text-primary'>Lilydale</h2>"+timeconversion(r,0))})}